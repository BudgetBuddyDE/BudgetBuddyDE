CREATE VIEW "budgetbuddy_backend"."transaction_history_summary_view" AS (select EXTRACT(MONTH FROM "processed_at") as "month", EXTRACT(YEAR FROM "processed_at") as "year", "owner_id", SUM(CASE WHEN "transfer_amount" > 0 THEN "transfer_amount" ELSE 0 END) as "income", SUM(CASE WHEN "transfer_amount" < 0 THEN ABS("transfer_amount") ELSE 0 END) as "expenses", SUM("transfer_amount") as "balance" from "budgetbuddy_backend"."transaction" group by EXTRACT(MONTH FROM "budgetbuddy_backend"."transaction"."processed_at"), EXTRACT(YEAR FROM "budgetbuddy_backend"."transaction"."processed_at"), "budgetbuddy_backend"."transaction"."owner_id");